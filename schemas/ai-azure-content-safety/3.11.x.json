{
  "fields": [
    {
      "protocols": {
        "elements": {
          "type": "string",
          "one_of": [
            "grpc",
            "grpcs",
            "http",
            "https"
          ]
        },
        "type": "set",
        "default": [
          "grpc",
          "grpcs",
          "http",
          "https"
        ],
        "required": true,
        "description": "A set of strings representing HTTP protocols."
      }
    },
    {
      "consumer": {
        "reference": "consumers",
        "type": "foreign",
        "eq": null,
        "description": "Custom type for representing a foreign key with a null value allowed."
      }
    },
    {
      "consumer_group": {
        "reference": "consumer_groups",
        "type": "foreign",
        "eq": null,
        "description": "Custom type for representing a foreign key with a null value allowed."
      }
    },
    {
      "config": {
        "fields": [
          {
            "content_safety_url": {
              "referenceable": true,
              "type": "string",
              "required": true,
              "description": "Full URL, inc protocol, of the Azure Content Safety instance."
            }
          },
          {
            "azure_api_version": {
              "len_min": 1,
              "default": "2023-10-01",
              "type": "string",
              "required": true,
              "description": "Sets the ?api-version URL parameter, used for defining the Azure Content Services interchange format."
            }
          },
          {
            "azure_use_managed_identity": {
              "type": "boolean",
              "default": false,
              "description": "If checked, uses (if set) `azure_client_id`, `azure_client_secret`, and/or `azure_tenant_id` for Azure authentication, via Managed or User-assigned identity"
            }
          },
          {
            "azure_client_id": {
              "type": "string",
              "required": false,
              "description": "If `azure_use_managed_identity` is true, set the client ID if required."
            }
          },
          {
            "azure_client_secret": {
              "type": "string",
              "required": false,
              "description": "If `azure_use_managed_identity` is true, set the client secret if required."
            }
          },
          {
            "azure_tenant_id": {
              "type": "string",
              "required": false,
              "description": "If `azure_use_managed_identity` is true, set the tenant ID if required."
            }
          },
          {
            "content_safety_key": {
              "referenceable": true,
              "encrypted": true,
              "type": "string",
              "required": false,
              "description": "If `azure_use_managed_identity` is true, set the API key to call Content Safety."
            }
          },
          {
            "text_source": {
              "one_of": [
                "concatenate_all_content",
                "concatenate_user_content"
              ],
              "default": "concatenate_all_content",
              "type": "string",
              "description": "Select where to pick the 'text' for the Azure Content Services request."
            }
          },
          {
            "categories": {
              "type": "array",
              "elements": {
                "fields": [
                  {
                    "name": {
                      "required": true,
                      "type": "string"
                    }
                  },
                  {
                    "rejection_level": {
                      "required": true,
                      "type": "integer"
                    }
                  }
                ],
                "type": "record",
                "required": true
              },
              "description": "Array of categories, and their thresholds, to measure on."
            }
          },
          {
            "reveal_failure_reason": {
              "type": "boolean",
              "default": true,
              "description": "Set true to tell the caller why their request was rejected, if so."
            }
          },
          {
            "output_type": {
              "one_of": [
                "FourSeverityLevels",
                "EightSeverityLevels"
              ],
              "default": "FourSeverityLevels",
              "type": "string",
              "description": "See https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/content-filter#content-filtering-categories"
            }
          },
          {
            "blocklist_names": {
              "type": "array",
              "elements": {
                "type": "string"
              },
              "description": "Use these configured blocklists (in Azure Content Services) when inspecting content."
            }
          },
          {
            "halt_on_blocklist_hit": {
              "type": "boolean",
              "default": true,
              "description": "Tells Azure to reject the request if any blocklist filter is hit."
            }
          }
        ],
        "type": "record",
        "required": true
      }
    }
  ],
  "entity_checks": [

  ]
}