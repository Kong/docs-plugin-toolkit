{
  "entity_checks": [
    {
      "conditional": {
        "if_field": "algorithm",
        "then_field": "rsa_public_key",
        "if_match": {
          "match_any": {
            "patterns": [
              "^RS256$",
              "^RS384$",
              "^RS512$"
            ]
          }
        },
        "then_match": {
          "required": true
        }
      }
    }
  ],
  "fields": [
    {
      "id": {
        "type": "string",
        "auto": true,
        "description": "A string representing a UUID (universally unique identifier).",
        "uuid": true
      }
    },
    {
      "created_at": {
        "type": "integer",
        "auto": true,
        "description": "An integer representing an automatic Unix timestamp in seconds.",
        "timestamp": true
      }
    },
    {
      "consumer": {
        "required": true,
        "reference": "consumers",
        "on_delete": "cascade",
        "type": "foreign"
      }
    },
    {
      "key": {
        "required": false,
        "auto": true,
        "type": "string",
        "unique": true
      }
    },
    {
      "secret": {
        "type": "string",
        "auto": true
      }
    },
    {
      "rsa_public_key": {
        "type": "string"
      }
    },
    {
      "algorithm": {
        "type": "string",
        "default": "HS256",
        "one_of": [
          "HS256",
          "HS384",
          "HS512",
          "RS256",
          "RS384",
          "RS512",
          "ES256",
          "ES384"
        ]
      }
    },
    {
      "tags": {
        "type": "set",
        "description": "A set of strings representing tags.",
        "elements": {
          "type": "string",
          "description": "A string representing a tag.",
          "required": true
        }
      }
    }
  ]
}